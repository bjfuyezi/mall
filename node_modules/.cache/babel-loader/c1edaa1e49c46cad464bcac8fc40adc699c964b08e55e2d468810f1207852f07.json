{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nexport default {\n  name: 'ProductView',\n  data() {\n    return {\n      product_id: '',\n      activeTab: 'description',\n      quantity: 1,\n      isFavorite: false,\n      product: {},\n      hotProducts: []\n    };\n  },\n  async created() {\n    try {\n      // 从路由获取商品ID\n      this.product_id = this.$route.params.id;\n\n      // 请求商品详情\n      const response = await axios.post(`http://localhost:8081/product/selectById`, {\n        id: this.product_id\n      });\n      if (response.status === 200) {\n        // 合并API返回的数据和默认数据\n        this.product = response.data;\n        const picResponse = await axios.post('http://localhost:8081/pic/getManyUrl', {\n          id: this.product.picture_id\n        });\n        if (picResponse.data != null) {\n          this.product.picture_id = picResponse.data;\n        }\n      } else {\n        throw new Error(response.data.message || '获取商品信息失败');\n      }\n    } catch (error) {\n      this.$message.error(error.message || '获取商品信息失败，请重试');\n      console.error('获取商品详情失败:', error);\n    }\n  },\n  methods: {\n    addToCart() {\n      this.$message.success('已添加到购物车');\n    },\n    toggleFavorite() {\n      this.isFavorite = !this.isFavorite;\n      this.$message.success(this.isFavorite ? '收藏成功' : '已取消收藏');\n    },\n    quickBuy() {\n      this.$router.push({\n        name: 'order-confirm',\n        query: {\n          productId: this.product.id,\n          quantity: this.quantity\n        }\n      });\n    },\n    previewImage(_url) {\n      this.$msgbox({\n        title: '图片预览',\n        message: ('img', {\n          attrs: {\n            src: _url,\n            style: 'max-width: 100%'\n          }\n        }),\n        showCancelButton: false,\n        confirmButtonText: '关闭'\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","product_id","activeTab","quantity","isFavorite","product","hotProducts","created","$route","params","id","response","post","status","picResponse","picture_id","Error","message","error","$message","console","methods","addToCart","success","toggleFavorite","quickBuy","$router","push","query","productId","previewImage","_url","$msgbox","title","attrs","src","style","showCancelButton","confirmButtonText"],"sources":["src/views/ProductView.vue"],"sourcesContent":["<template>\r\n  <div class=\"product-page\">\r\n    <div class=\"product-container\">\r\n      <!-- 左侧区域 -->\r\n      <div class=\"product-left\">\r\n        <!-- 商品主要信息 -->\r\n        <div class=\"product-main\">\r\n          <div class=\"product-gallery\">\r\n            <img :src=\"'http://localhost:8081'+product.picture_id[0]\" :alt=\"product.name\">\r\n          </div>\r\n          <div class=\"product-info\">\r\n            <h1>{{ product.name }}</h1>\r\n            <div class=\"product-price\">\r\n              <span class=\"current-price\">¥{{ product.price.toFixed(2) }}</span>\r\n              <span class=\"original-price\" v-if=\"product.originalPrice\">\r\n                ¥{{ product.originalPrice.toFixed(2) }}\r\n              </span>\r\n            </div>\r\n            <div class=\"product-stats\">\r\n              <span>销量 {{ product.salenum }}</span>\r\n              <span>评价 {{ product.reviews }}</span>\r\n              <span>收藏 {{ product.favorites }}</span>\r\n            </div>\r\n            <el-button \r\n              type=\"danger\" \r\n              class=\"quick-buy-btn\"\r\n              size=\"large\"\r\n              @click=\"quickBuy\"\r\n            >\r\n              立即购买\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 商品详情标签页 -->\r\n        <div class=\"product-tabs\">\r\n          <el-tabs v-model=\"activeTab\">\r\n            <el-tab-pane label=\"商品介绍\" name=\"description\">\r\n              <div class=\"product-description\">\r\n                <div v-html=\"product.description\"></div>\r\n              </div>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"商品评价\" name=\"reviews\">\r\n              <div class=\"product-reviews\">\r\n                <div class=\"review-item\" v-for=\"review in product.reviewList\" :key=\"review.id\">\r\n                  <div class=\"review-header\">\r\n                    <img :src=\"review.userAvatar\" :alt=\"review.userName\">\r\n                    <span class=\"user-name\">{{ review.userName }}</span>\r\n                    <el-rate v-model=\"review.rating\" disabled></el-rate>\r\n                  </div>\r\n                  <div class=\"review-content\">{{ review.content }}</div>\r\n                  <div class=\"review-images\" v-if=\"review.images && review.images.length\">\r\n                    <img v-for=\"(img, index) in review.images\" \r\n                         :key=\"index\" \r\n                         :src=\"img\" \r\n                         @click=\"previewImage(img)\"\r\n                    >\r\n                  </div>\r\n                  <div class=\"review-time\">{{ review.time }}</div>\r\n                </div>\r\n              </div>\r\n            </el-tab-pane>\r\n          </el-tabs>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 右侧区域 -->\r\n      <div class=\"product-right\">\r\n        <!-- 购买操作区 -->\r\n        <div class=\"product-action\">\r\n          <div class=\"quantity-selector\">\r\n            <span>购买数量：</span>\r\n            <el-input-number \r\n              v-model=\"quantity\" \r\n              :min=\"1\" \r\n              :max=\"product.stock\"\r\n            ></el-input-number>\r\n          </div>\r\n          <div class=\"action-buttons\">\r\n            <el-button type=\"primary\" @click=\"addToCart\">加入购物车</el-button>\r\n            <el-button @click=\"toggleFavorite\">\r\n              <i :class=\"isFavorite ? 'el-icon-star-on' : 'el-icon-star-off'\"></i>\r\n              {{ isFavorite ? '已收藏' : '收藏' }}\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 热门商品推荐 -->\r\n        <div class=\"hot-products\">\r\n          <h3>热门商品</h3>\r\n          <div class=\"hot-product-list\">\r\n            <div \r\n              v-for=\"item in hotProducts\" \r\n              :key=\"item.id\"\r\n              class=\"hot-product-item\"\r\n              @click=\"$router.push(`/product/${item.id}`)\"\r\n            >\r\n              <img :src=\"item.image\" :alt=\"item.name\">\r\n              <div class=\"hot-product-info\">\r\n                <p class=\"name\">{{ item.name }}</p>\r\n                <p class=\"price\">¥{{ item.price.toFixed(2) }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'ProductView',\r\n  data() {\r\n    return {\r\n      product_id: '',\r\n      activeTab: 'description',\r\n      quantity: 1,\r\n      isFavorite: false,\r\n      product: {},\r\n      hotProducts: []\r\n    }\r\n  },\r\n  async created() {\r\n    try {\r\n      // 从路由获取商品ID\r\n      this.product_id = this.$route.params.id;\r\n      \r\n      // 请求商品详情\r\n      const response = await axios.post(`http://localhost:8081/product/selectById`,{id:this.product_id});\r\n\r\n      if (response.status === 200) {\r\n        // 合并API返回的数据和默认数据\r\n        this.product = response.data;\r\n        const picResponse = await axios.post('http://localhost:8081/pic/getManyUrl', {id:this.product.picture_id});\r\n          if ( picResponse.data != null ) {\r\n            this.product.picture_id = picResponse.data;\r\n          }\r\n      } else {\r\n        throw new Error(response.data.message || '获取商品信息失败');\r\n      }\r\n    } catch (error) {\r\n      this.$message.error(error.message || '获取商品信息失败，请重试');\r\n      console.error('获取商品详情失败:', error);\r\n    }\r\n  },\r\n  methods: {\r\n    addToCart() {\r\n      this.$message.success('已添加到购物车')\r\n    },\r\n    toggleFavorite() {\r\n      this.isFavorite = !this.isFavorite\r\n      this.$message.success(this.isFavorite ? '收藏成功' : '已取消收藏')\r\n    },\r\n    quickBuy() {\r\n      this.$router.push({\r\n        name: 'order-confirm',\r\n        query: {\r\n          productId: this.product.id,\r\n          quantity: this.quantity\r\n        }\r\n      });\r\n    },\r\n    previewImage(_url) {\r\n      this.$msgbox({\r\n        title: '图片预览',\r\n        message: ('img', {\r\n          attrs: {\r\n            src: _url,\r\n            style: 'max-width: 100%'\r\n          }\r\n        }),\r\n        showCancelButton: false,\r\n        confirmButtonText: '关闭'\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.product-page {\r\n  background-color: #f5f5f5;\r\n  padding: 20px 0;\r\n}\r\n\r\n.product-container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.product-left {\r\n  flex: 1;\r\n  min-width: 0;\r\n}\r\n\r\n.product-main {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  margin-bottom: 20px;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.product-gallery {\r\n  width: 400px;\r\n  position: relative;\r\n  \r\n  img {\r\n    width: 100%;\r\n    height: auto;\r\n    border-radius: 4px;\r\n  }\r\n}\r\n\r\n.product-info {\r\n  flex: 1;\r\n\r\n  h1 {\r\n    font-size: 24px;\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .product-price {\r\n    margin-bottom: 20px;\r\n\r\n    .current-price {\r\n      font-size: 28px;\r\n      color: #ff6700;\r\n      margin-right: 10px;\r\n    }\r\n\r\n    .original-price {\r\n      color: #999;\r\n      text-decoration: line-through;\r\n    }\r\n  }\r\n\r\n  .product-stats {\r\n    color: #666;\r\n    margin-bottom: 20px;\r\n    \r\n    span {\r\n      margin-right: 20px;\r\n    }\r\n  }\r\n\r\n  .quick-buy-btn {\r\n    width: 180px;\r\n    height: 48px;\r\n    font-size: 18px;\r\n    margin-top: 10px;\r\n  }\r\n}\r\n\r\n.product-tabs {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n\r\n  .product-description {\r\n    padding: 20px 0;\r\n  }\r\n\r\n  .review-item {\r\n    padding: 20px 0;\r\n    border-bottom: 1px solid #eee;\r\n\r\n    .review-header {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 10px;\r\n      margin-bottom: 10px;\r\n\r\n      img {\r\n        width: 40px;\r\n        height: 40px;\r\n        border-radius: 50%;\r\n      }\r\n    }\r\n\r\n    .review-images {\r\n      display: flex;\r\n      gap: 10px;\r\n      margin: 10px 0;\r\n\r\n      img {\r\n        width: 100px;\r\n        height: 100px;\r\n        object-fit: cover;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n\r\n    .review-time {\r\n      color: #999;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n}\r\n\r\n.product-right {\r\n  width: 300px;\r\n}\r\n\r\n.product-action {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  margin-bottom: 20px;\r\n\r\n  .quantity-selector {\r\n    margin-bottom: 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n  }\r\n\r\n  .action-buttons {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n\r\n    .el-button {\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n\r\n.hot-products {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n\r\n  h3 {\r\n    margin-bottom: 15px;\r\n    font-size: 16px;\r\n  }\r\n\r\n  .hot-product-item {\r\n    display: flex;\r\n    gap: 10px;\r\n    padding: 10px 0;\r\n    cursor: pointer;\r\n\r\n    &:hover {\r\n      background: #f9f9f9;\r\n    }\r\n\r\n    img {\r\n      width: 80px;\r\n      height: 80px;\r\n      object-fit: cover;\r\n      border-radius: 4px;\r\n    }\r\n\r\n    .hot-product-info {\r\n      flex: 1;\r\n\r\n      .name {\r\n        margin-bottom: 5px;\r\n        font-size: 14px;\r\n      }\r\n\r\n      .price {\r\n        color: #ff6700;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style> "],"mappings":";AA+GA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,UAAA;MACAC,SAAA;MACAC,QAAA;MACAC,UAAA;MACAC,OAAA;MACAC,WAAA;IACA;EACA;EACA,MAAAC,QAAA;IACA;MACA;MACA,KAAAN,UAAA,QAAAO,MAAA,CAAAC,MAAA,CAAAC,EAAA;;MAEA;MACA,MAAAC,QAAA,SAAAb,KAAA,CAAAc,IAAA;QAAAF,EAAA,OAAAT;MAAA;MAEA,IAAAU,QAAA,CAAAE,MAAA;QACA;QACA,KAAAR,OAAA,GAAAM,QAAA,CAAAX,IAAA;QACA,MAAAc,WAAA,SAAAhB,KAAA,CAAAc,IAAA;UAAAF,EAAA,OAAAL,OAAA,CAAAU;QAAA;QACA,IAAAD,WAAA,CAAAd,IAAA;UACA,KAAAK,OAAA,CAAAU,UAAA,GAAAD,WAAA,CAAAd,IAAA;QACA;MACA;QACA,UAAAgB,KAAA,CAAAL,QAAA,CAAAX,IAAA,CAAAiB,OAAA;MACA;IACA,SAAAC,KAAA;MACA,KAAAC,QAAA,CAAAD,KAAA,CAAAA,KAAA,CAAAD,OAAA;MACAG,OAAA,CAAAF,KAAA,cAAAA,KAAA;IACA;EACA;EACAG,OAAA;IACAC,UAAA;MACA,KAAAH,QAAA,CAAAI,OAAA;IACA;IACAC,eAAA;MACA,KAAApB,UAAA,SAAAA,UAAA;MACA,KAAAe,QAAA,CAAAI,OAAA,MAAAnB,UAAA;IACA;IACAqB,SAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;QACA5B,IAAA;QACA6B,KAAA;UACAC,SAAA,OAAAxB,OAAA,CAAAK,EAAA;UACAP,QAAA,OAAAA;QACA;MACA;IACA;IACA2B,aAAAC,IAAA;MACA,KAAAC,OAAA;QACAC,KAAA;QACAhB,OAAA;UACAiB,KAAA;YACAC,GAAA,EAAAJ,IAAA;YACAK,KAAA;UACA;QACA;QACAC,gBAAA;QACAC,iBAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}