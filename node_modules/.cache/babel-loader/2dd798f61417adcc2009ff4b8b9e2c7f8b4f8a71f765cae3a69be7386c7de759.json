{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport axios from 'axios';\nexport default {\n  name: 'ProductView',\n  data() {\n    return {\n      shop_name: '',\n      selectedImage: '',\n      product_id: '',\n      activeTab: 'description',\n      quantity: 1,\n      // 默认购买数量\n      selectedFlavor: '',\n      // 当前选中的口味\n      maxQuantity: 0,\n      // 当前选中口味的最大购买数量\n      isFavorite: false,\n      product: {},\n      hotProducts: []\n    };\n  },\n  async created() {\n    try {\n      // 从路由获取商品ID\n      this.product_id = this.$route.params.id;\n\n      // 请求商品详情\n      const response = await axios.post(`http://localhost:8081/product/selectById`, {\n        id: this.product_id\n      });\n      if (response.status === 200) {\n        // 合并API返回的数据和默认数据\n        this.product = response.data;\n        this.product.quantity = JSON.parse(this.product.quantity);\n        const picResponse = await axios.post('http://localhost:8081/pic/getManyUrl', {\n          id: this.product.picture_id\n        });\n        if (picResponse.data != null) {\n          this.product.picture_id = picResponse.data;\n          this.selectedImage = this.product.picture_id[0];\n        }\n        const shopResponse = await axios.post('http://localhost:8081/shop/getById', {\n          id: this.product.shop_id\n        });\n        if (shopResponse.data != null) {\n          this.shop_name = shopResponse.data.shop_name;\n        }\n      } else {\n        throw new Error(response.data.message || '获取商品信息失败');\n      }\n    } catch (error) {\n      this.$message.error(error.message || '获取商品信息失败，请重试');\n      console.error('获取商品详情失败:', error);\n    }\n  },\n  methods: {\n    toShop() {},\n    // 更新购买数量的最大值\n    updateMaxQuantity() {\n      const selectedFlavorObj = this.product.quantity.find(flavor => flavor.flavor === this.selectedFlavor);\n      this.maxQuantity = selectedFlavorObj ? selectedFlavorObj.quantity : 0;\n      this.maxQuantity = Number(this.maxQuantity);\n      this.quantity = 1;\n    },\n    selectImage(image) {\n      this.selectedImage = image; // 点击缩略图时更新大图\n    },\n    addToCart(quantity, selectedFlavor, product_id) {\n      console.log(quantity, selectedFlavor, product_id);\n      this.$message.success('已添加到购物车');\n    },\n    toggleFavorite() {\n      this.isFavorite = !this.isFavorite;\n      this.$message.success(this.isFavorite ? '收藏成功' : '已取消收藏');\n    },\n    previewImage(_url) {\n      this.$msgbox({\n        title: '图片预览',\n        message: ('img', {\n          attrs: {\n            src: _url,\n            style: 'max-width: 100%'\n          }\n        }),\n        showCancelButton: false,\n        confirmButtonText: '关闭'\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","shop_name","selectedImage","product_id","activeTab","quantity","selectedFlavor","maxQuantity","isFavorite","product","hotProducts","created","$route","params","id","response","post","status","JSON","parse","picResponse","picture_id","shopResponse","shop_id","Error","message","error","$message","console","methods","toShop","updateMaxQuantity","selectedFlavorObj","find","flavor","Number","selectImage","image","addToCart","log","success","toggleFavorite","previewImage","_url","$msgbox","title","attrs","src","style","showCancelButton","confirmButtonText"],"sources":["src/views/ProductView.vue"],"sourcesContent":["<template>\r\n  <div class=\"product-page\">\r\n    <div class=\"product-container\">\r\n      <!-- 左侧区域 -->\r\n      <div class=\"product-left\">\r\n        <!-- 商品主要信息 -->\r\n        <div class=\"product-main\">\r\n          <div class=\"product-gallery\">\r\n            <div class=\"image-gallery\">\r\n              <!-- 显示大图 -->\r\n              <div class=\"main-image\">\r\n                <img :src=\"'http://localhost:8081' + selectedImage\" :alt=\"product.name\" class=\"large-image\" />\r\n              </div>\r\n\r\n              <!-- 显示缩略图列表 -->\r\n              <div class=\"thumbnail-list\">\r\n                <div \r\n                  v-for=\"(image, index) in product.picture_id\" \r\n                  :key=\"index\" \r\n                  class=\"thumbnail\"\r\n                  :class=\"{'active': image === selectedImage}\" \r\n                  @click=\"selectImage(image)\"\r\n                >\r\n                  <img :src=\"'http://localhost:8081' + image\" :alt=\"`Image ${index + 1}`\" class=\"thumbnail-img\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"product-info\">\r\n            <h1>{{ product.name }}</h1>\r\n            <div class=\"product-price\">\r\n              <span class=\"current-price\">¥{{ product.price.toFixed(2) }}</span>\r\n              <span class=\"original-price\" v-if=\"product.originalPrice\">\r\n                ¥{{ product.originalPrice.toFixed(2) }}\r\n              </span>\r\n            </div>\r\n            <div class=\"product-stats\">\r\n              <span>销量 {{ product.salenum }}</span><br/>\r\n              <span>评价 {{ product.reviews }}</span><br/>\r\n              <span>收藏 {{ product.favorites }}</span><br/>\r\n              <span>地点 {{ product.location }}</span><br/>\r\n              <span>所属店铺 {{ shop_name }}</span><br/>\r\n            </div>\r\n            <el-button type=\"primary\" @click=\"toShop(product.shop_id)\">查看店铺其他商品</el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 商品详情标签页 -->\r\n        <div class=\"product-tabs\">\r\n          <el-tabs v-model=\"activeTab\">\r\n            <el-tab-pane label=\"商品介绍\" name=\"description\">\r\n              <div class=\"product-description\">\r\n                <div v-html=\"product.description\"></div>\r\n              </div>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"商品评价\" name=\"reviews\">\r\n              <div class=\"product-reviews\">\r\n                <div class=\"review-item\" v-for=\"review in product.reviewList\" :key=\"review.id\">\r\n                  <div class=\"review-header\">\r\n                    <img :src=\"review.userAvatar\" :alt=\"review.userName\">\r\n                    <span class=\"user-name\">{{ review.userName }}</span>\r\n                    <el-rate v-model=\"review.rating\" disabled></el-rate>\r\n                  </div>\r\n                  <div class=\"review-content\">{{ review.content }}</div>\r\n                  <div class=\"review-images\" v-if=\"review.images && review.images.length\">\r\n                    <img v-for=\"(img, index) in review.images\" \r\n                         :key=\"index\" \r\n                         :src=\"img\" \r\n                         @click=\"previewImage(img)\"\r\n                    >\r\n                  </div>\r\n                  <div class=\"review-time\">{{ review.time }}</div>\r\n                </div>\r\n              </div>\r\n            </el-tab-pane>\r\n          </el-tabs>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 右侧区域 -->\r\n      <div class=\"product-right\">\r\n        <!-- 购买操作区 -->\r\n        <div class=\"product-action\">\r\n          <div class=\"quantity-selector\">\r\n            <span>购买数量：</span>\r\n\r\n            <!-- 口味单选按钮 -->\r\n            <div class=\"flavor-options\">\r\n              <el-radio-group v-model=\"selectedFlavor\" @change=\"updateMaxQuantity\">\r\n                <el-radio \r\n                  v-for=\"(flavor, index) in product.quantity\" \r\n                  :key=\"index\" \r\n                  :label=\"flavor.flavor\"\r\n                  :value=\"flavor.flavor\"\r\n                >\r\n                  {{ flavor.flavor }}\r\n                </el-radio>\r\n              </el-radio-group>\r\n            </div>\r\n\r\n            <!-- 数量选择 -->\r\n            <el-input-number \r\n              v-model=\"quantity\" \r\n              :min=\"1\" \r\n              :max=\"maxQuantity\"\r\n              :disabled=\"!selectedFlavor\"\r\n            ></el-input-number>\r\n          </div>\r\n          <div class=\"action-buttons\">\r\n            <el-button type=\"primary\" @click=\"addToCart(this.quantity,this.selectedFlavor,this.product.product_id)\">加入购物车</el-button>\r\n            <el-button @click=\"toggleFavorite\">\r\n              <i :class=\"isFavorite ? 'el-icon-star-on' : 'el-icon-star-off'\"></i>\r\n              {{ isFavorite ? '已收藏' : '收藏' }}\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 热门商品推荐 -->\r\n        <div class=\"hot-products\">\r\n          <h3>热门商品</h3>\r\n          <div class=\"hot-product-list\">\r\n            <div \r\n              v-for=\"item in hotProducts\" \r\n              :key=\"item.id\"\r\n              class=\"hot-product-item\"\r\n              @click=\"$router.push(`/product/${item.id}`)\"\r\n            >\r\n              <img :src=\"item.image\" :alt=\"item.name\">\r\n              <div class=\"hot-product-info\">\r\n                <p class=\"name\">{{ item.name }}</p>\r\n                <p class=\"price\">¥{{ item.price.toFixed(2) }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'ProductView',\r\n  data() {\r\n    return {\r\n      shop_name:'',\r\n      selectedImage:'',\r\n      product_id: '',\r\n      activeTab: 'description',\r\n      quantity: 1, // 默认购买数量\r\n      selectedFlavor: '', // 当前选中的口味\r\n      maxQuantity: 0, // 当前选中口味的最大购买数量\r\n      isFavorite: false,\r\n      product: {},\r\n      hotProducts: []\r\n    }\r\n  },\r\n  async created() {\r\n    try {\r\n      // 从路由获取商品ID\r\n      this.product_id = this.$route.params.id;\r\n      \r\n      // 请求商品详情\r\n      const response = await axios.post(`http://localhost:8081/product/selectById`,{id:this.product_id});\r\n\r\n      if (response.status === 200) {\r\n        // 合并API返回的数据和默认数据\r\n        this.product = response.data;\r\n        this.product.quantity = JSON.parse(this.product.quantity);\r\n        const picResponse = await axios.post('http://localhost:8081/pic/getManyUrl', {id:this.product.picture_id});\r\n          if ( picResponse.data != null ) {\r\n            this.product.picture_id = picResponse.data;\r\n            this.selectedImage=this.product.picture_id[0];\r\n          }\r\n        const shopResponse = await axios.post('http://localhost:8081/shop/getById', {id:this.product.shop_id});\r\n        if ( shopResponse.data != null ) {\r\n            this.shop_name = shopResponse.data.shop_name;\r\n          }\r\n      } else {\r\n        throw new Error(response.data.message || '获取商品信息失败');\r\n      }\r\n    } catch (error) {\r\n      this.$message.error(error.message || '获取商品信息失败，请重试');\r\n      console.error('获取商品详情失败:', error);\r\n    }\r\n  },\r\n  methods: {\r\n    toShop(){\r\n\r\n    },\r\n    // 更新购买数量的最大值\r\n    updateMaxQuantity() {\r\n      const selectedFlavorObj = this.product.quantity.find(flavor => flavor.flavor === this.selectedFlavor);\r\n      this.maxQuantity = selectedFlavorObj ? selectedFlavorObj.quantity : 0;\r\n      this.maxQuantity = Number(this.maxQuantity);\r\n      this.quantity = 1;\r\n    },\r\n    selectImage(image) {\r\n      this.selectedImage = image;  // 点击缩略图时更新大图\r\n    },\r\n    addToCart(quantity,selectedFlavor,product_id) {\r\n      console.log(quantity, selectedFlavor, product_id);\r\n      this.$message.success('已添加到购物车')\r\n    },\r\n    toggleFavorite() {\r\n      this.isFavorite = !this.isFavorite\r\n      this.$message.success(this.isFavorite ? '收藏成功' : '已取消收藏')\r\n    },\r\n    previewImage(_url) {\r\n      this.$msgbox({\r\n        title: '图片预览',\r\n        message: ('img', {\r\n          attrs: {\r\n            src: _url,\r\n            style: 'max-width: 100%'\r\n          }\r\n        }),\r\n        showCancelButton: false,\r\n        confirmButtonText: '关闭'\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.product-page {\r\n  background-color: #f5f5f5;\r\n  padding: 20px 0;\r\n}\r\n\r\n.product-container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.product-left {\r\n  flex: 1;\r\n  min-width: 0;\r\n}\r\n\r\n.product-main {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  margin-bottom: 20px;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.product-gallery {\r\n  width: 400px;\r\n  position: relative;\r\n  \r\n  img {\r\n    width: 100%;\r\n    height: auto;\r\n    border-radius: 4px;\r\n  }\r\n}\r\n\r\n.product-info {\r\n  flex: 1;\r\n\r\n  h1 {\r\n    font-size: 24px;\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .product-price {\r\n    margin-bottom: 20px;\r\n\r\n    .current-price {\r\n      font-size: 28px;\r\n      color: #ff6700;\r\n      margin-right: 10px;\r\n    }\r\n\r\n    .original-price {\r\n      color: #999;\r\n      text-decoration: line-through;\r\n    }\r\n  }\r\n\r\n  .product-stats {\r\n    color: #666;\r\n    margin-bottom: 20px;\r\n    \r\n    span {\r\n      margin-right: 20px;\r\n    }\r\n  }\r\n\r\n  .quick-buy-btn {\r\n    width: 180px;\r\n    height: 48px;\r\n    font-size: 18px;\r\n    margin-top: 10px;\r\n  }\r\n}\r\n\r\n.product-tabs {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n\r\n  .product-description {\r\n    padding: 20px 0;\r\n  }\r\n\r\n  .review-item {\r\n    padding: 20px 0;\r\n    border-bottom: 1px solid #eee;\r\n\r\n    .review-header {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 10px;\r\n      margin-bottom: 10px;\r\n\r\n      img {\r\n        width: 40px;\r\n        height: 40px;\r\n        border-radius: 50%;\r\n      }\r\n    }\r\n\r\n    .review-images {\r\n      display: flex;\r\n      gap: 10px;\r\n      margin: 10px 0;\r\n\r\n      img {\r\n        width: 100px;\r\n        height: 100px;\r\n        object-fit: cover;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n\r\n    .review-time {\r\n      color: #999;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n}\r\n\r\n.product-right {\r\n  width: 300px;\r\n}\r\n\r\n.product-action {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  margin-bottom: 20px;\r\n\r\n  .quantity-selector {\r\n    margin-bottom: 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n  }\r\n\r\n  .action-buttons {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n\r\n    .el-button {\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n\r\n.hot-products {\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n\r\n  h3 {\r\n    margin-bottom: 15px;\r\n    font-size: 16px;\r\n  }\r\n\r\n  .hot-product-item {\r\n    display: flex;\r\n    gap: 10px;\r\n    padding: 10px 0;\r\n    cursor: pointer;\r\n\r\n    &:hover {\r\n      background: #f9f9f9;\r\n    }\r\n\r\n    img {\r\n      width: 80px;\r\n      height: 80px;\r\n      object-fit: cover;\r\n      border-radius: 4px;\r\n    }\r\n\r\n    .hot-product-info {\r\n      flex: 1;\r\n\r\n      .name {\r\n        margin-bottom: 5px;\r\n        font-size: 14px;\r\n      }\r\n\r\n      .price {\r\n        color: #ff6700;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.image-gallery {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.main-image {\r\n  width: 200px;\r\n  height: 200px;\r\n  object-fit: cover;\r\n  border-radius: 5px;\r\n}\r\n\r\n.large-image {\r\n  max-width: 600px;\r\n  max-height: 400px;\r\n}\r\n\r\n.thumbnail-list {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 10px;\r\n}\r\n\r\n.thumbnail {\r\n  cursor: pointer;\r\n  transition: transform 0.3s;\r\n  width: 80px;   /* 统一宽度 */\r\n  height: 80px;  /* 统一高度 */\r\n  border-radius: 4px; /* 可选的圆角效果 */\r\n  overflow: hidden;\r\n  border: 2px solid transparent; /* 默认无边框 */\r\n}\r\n\r\n.thumbnail:hover {\r\n  transform: scale(1.1); /* 鼠标悬停时缩略图稍微放大 */\r\n}\r\n\r\n.thumbnail-img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover; /* 图片填充容器，保持比例 */\r\n}\r\n\r\n.thumbnail.active {\r\n  border: 2px solid #409EFF; /* 给选中的缩略图加边框 */\r\n}\r\n\r\n.quantity-selector {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.flavor-options {\r\n  display: flex;\r\n  gap: 15px;\r\n}\r\n\r\n.el-radio {\r\n  display: inline-block;\r\n  margin-right: 10px;\r\n  padding: 10px;\r\n  border-radius: 5px;\r\n  background-color: #f7f7f7;\r\n  cursor: pointer;\r\n}\r\n\r\n.el-radio.is-checked {\r\n  background-color: #409EFF;\r\n  color: #fff;\r\n}\r\n\r\n.el-input-number {\r\n  width: 200px;\r\n}\r\n</style> "],"mappings":";;AA6IA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,aAAA;MACAC,UAAA;MACAC,SAAA;MACAC,QAAA;MAAA;MACAC,cAAA;MAAA;MACAC,WAAA;MAAA;MACAC,UAAA;MACAC,OAAA;MACAC,WAAA;IACA;EACA;EACA,MAAAC,QAAA;IACA;MACA;MACA,KAAAR,UAAA,QAAAS,MAAA,CAAAC,MAAA,CAAAC,EAAA;;MAEA;MACA,MAAAC,QAAA,SAAAjB,KAAA,CAAAkB,IAAA;QAAAF,EAAA,OAAAX;MAAA;MAEA,IAAAY,QAAA,CAAAE,MAAA;QACA;QACA,KAAAR,OAAA,GAAAM,QAAA,CAAAf,IAAA;QACA,KAAAS,OAAA,CAAAJ,QAAA,GAAAa,IAAA,CAAAC,KAAA,MAAAV,OAAA,CAAAJ,QAAA;QACA,MAAAe,WAAA,SAAAtB,KAAA,CAAAkB,IAAA;UAAAF,EAAA,OAAAL,OAAA,CAAAY;QAAA;QACA,IAAAD,WAAA,CAAApB,IAAA;UACA,KAAAS,OAAA,CAAAY,UAAA,GAAAD,WAAA,CAAApB,IAAA;UACA,KAAAE,aAAA,QAAAO,OAAA,CAAAY,UAAA;QACA;QACA,MAAAC,YAAA,SAAAxB,KAAA,CAAAkB,IAAA;UAAAF,EAAA,OAAAL,OAAA,CAAAc;QAAA;QACA,IAAAD,YAAA,CAAAtB,IAAA;UACA,KAAAC,SAAA,GAAAqB,YAAA,CAAAtB,IAAA,CAAAC,SAAA;QACA;MACA;QACA,UAAAuB,KAAA,CAAAT,QAAA,CAAAf,IAAA,CAAAyB,OAAA;MACA;IACA,SAAAC,KAAA;MACA,KAAAC,QAAA,CAAAD,KAAA,CAAAA,KAAA,CAAAD,OAAA;MACAG,OAAA,CAAAF,KAAA,cAAAA,KAAA;IACA;EACA;EACAG,OAAA;IACAC,OAAA,GAEA;IACA;IACAC,kBAAA;MACA,MAAAC,iBAAA,QAAAvB,OAAA,CAAAJ,QAAA,CAAA4B,IAAA,CAAAC,MAAA,IAAAA,MAAA,CAAAA,MAAA,UAAA5B,cAAA;MACA,KAAAC,WAAA,GAAAyB,iBAAA,GAAAA,iBAAA,CAAA3B,QAAA;MACA,KAAAE,WAAA,GAAA4B,MAAA,MAAA5B,WAAA;MACA,KAAAF,QAAA;IACA;IACA+B,YAAAC,KAAA;MACA,KAAAnC,aAAA,GAAAmC,KAAA;IACA;IACAC,UAAAjC,QAAA,EAAAC,cAAA,EAAAH,UAAA;MACAyB,OAAA,CAAAW,GAAA,CAAAlC,QAAA,EAAAC,cAAA,EAAAH,UAAA;MACA,KAAAwB,QAAA,CAAAa,OAAA;IACA;IACAC,eAAA;MACA,KAAAjC,UAAA,SAAAA,UAAA;MACA,KAAAmB,QAAA,CAAAa,OAAA,MAAAhC,UAAA;IACA;IACAkC,aAAAC,IAAA;MACA,KAAAC,OAAA;QACAC,KAAA;QACApB,OAAA;UACAqB,KAAA;YACAC,GAAA,EAAAJ,IAAA;YACAK,KAAA;UACA;QACA;QACAC,gBAAA;QACAC,iBAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}