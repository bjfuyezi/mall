{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport axios from 'axios'; // 暂时注释掉未使用的导入\n\nexport default {\n  name: 'ShopAuditView',\n  data() {\n    return {\n      formattedProductDetails: [],\n      // 用于展示详情和修改\n      dialogInfoVisible: false,\n      // 详情弹窗\n      shopList: [],\n      rejectDialogVisible: false,\n      rejectReason: '',\n      currentShop: null\n    };\n  },\n  methods: {\n    async viewDetails(product) {\n      let pictures = '';\n      // 查images的url\n      const imageResponse = await axios.post('http://localhost:8081/pic/getUrl', {\n        id: product.picture_id\n      });\n      if (imageResponse.data != null) {\n        pictures = imageResponse.data;\n      }\n      // 格式化商品详情数据，适配弹窗中表格的展示\n      this.formattedProductDetails = [{\n        label: '店铺名称',\n        value: product.shop_name\n      }, {\n        label: '店铺描述',\n        value: product.shop_description\n      }, {\n        label: '创建时间',\n        value: product.created_time\n      }, {\n        label: '更新时间',\n        value: product.updated_time\n      }, {\n        label: '店铺等级',\n        value: product.level\n      }, {\n        label: '许可证',\n        value: pictures\n      }, {\n        label: '特产地',\n        value: product.location\n      }];\n\n      // 打开弹窗\n      this.dialogInfoVisible = true;\n    },\n    // eslint-disable-next-line no-unused-vars\n    async approveShop(shop) {\n      const proAddResponse = await axios.post('http://localhost:8081/shop/status', {\n        id: shop.shop_id,\n        status: \"closed\"\n      });\n      if (proAddResponse.status === 200) {\n        alert('已通过审核');\n        window.location.reload();\n      }\n    },\n    rejectShop(shop) {\n      this.currentShop = shop;\n      this.rejectDialogVisible = true;\n    },\n    async confirmReject() {\n      const proAddResponse = await axios.post('http://localhost:8081/shop/insertReason', {\n        id: this.currentShop.shop_id,\n        status: \"suspended\",\n        reason: this.rejectReason\n      });\n      if (proAddResponse.status === 200) {\n        alert('已驳回申请');\n        window.location.reload();\n      }\n      this.rejectDialogVisible = false;\n    }\n  },\n  async created() {\n    const proAddResponse = await axios.post('http://localhost:8081/shop/', {});\n    if (proAddResponse.data != null) {\n      this.shopList = proAddResponse.data.filter(product => product.status === 'waiting');\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","formattedProductDetails","dialogInfoVisible","shopList","rejectDialogVisible","rejectReason","currentShop","methods","viewDetails","product","pictures","imageResponse","post","id","picture_id","label","value","shop_name","shop_description","created_time","updated_time","level","location","approveShop","shop","proAddResponse","shop_id","status","alert","window","reload","rejectShop","confirmReject","reason","created","filter"],"sources":["src/views/admin/ShopAuditView.vue"],"sourcesContent":["<template>\r\n  <div class=\"shop-audit\">\r\n    <el-table :data=\"shopList\" style=\"width: 100%\">\r\n      <el-table-column prop=\"shop_name\" label=\"店铺名称\"></el-table-column>\r\n      <el-table-column prop=\"shop_description\" label=\"店铺描述\"></el-table-column>\r\n      <el-table-column prop=\"location\" label=\"所在地\"></el-table-column>\r\n      <el-table-column prop=\"updated_time\" label=\"申请时间\"></el-table-column>\r\n      <el-table-column label=\"操作\" width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"mini\" @click=\"viewDetails(scope.row)\">查看详情</el-button>\r\n          <el-button size=\"mini\" type=\"success\" @click=\"approveShop(scope.row)\">通过</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" @click=\"rejectShop(scope.row)\">驳回</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 驳回原因对话框 -->\r\n    <el-dialog title=\"驳回原因\" :visible.sync=\"rejectDialogVisible\" width=\"30%\">\r\n      <el-input\r\n        type=\"textarea\"\r\n        :rows=\"4\"\r\n        placeholder=\"请输入驳回原因\"\r\n        v-model=\"rejectReason\">\r\n      </el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"rejectDialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmReject\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <!-- 商品详情弹窗 -->\r\n    <el-dialog :visible.sync=\"dialogInfoVisible\" title=\"店铺详情\">\r\n      <el-table :data=\"this.formattedProductDetails\" style=\"width: 100%\">\r\n        <el-table-column prop=\"label\"></el-table-column>\r\n        <el-table-column prop=\"value\">\r\n          <template slot-scope=\"scope\">\r\n            <!-- 判断是否为商品图片 -->\r\n            <template v-if=\"scope.row.label === '许可证'\">\r\n              <img :src=\"'http://localhost:8081'+scope.row.value\" alt=\"商品图片\" style=\"width: 50px; height: 50px; object-fit: cover;\" />\r\n            </template>\r\n            <!-- 显示其他字段 -->\r\n            <template v-else>\r\n              <span>{{ scope.row.value }}</span>\r\n            </template>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogInfoVisible = false\">关闭</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';  // 暂时注释掉未使用的导入\r\n\r\nexport default {\r\n  name: 'ShopAuditView',\r\n  data() {\r\n    return {\r\n      formattedProductDetails:[],   // 用于展示详情和修改\r\n      dialogInfoVisible: false,     // 详情弹窗\r\n      shopList: [],\r\n      rejectDialogVisible: false,\r\n      rejectReason: '',\r\n      currentShop: null\r\n    }\r\n  },\r\n  methods: {\r\n    async viewDetails(product) {\r\n      let pictures = '';\r\n      // 查images的url\r\n      const imageResponse = await axios.post('http://localhost:8081/pic/getUrl', {id:product.picture_id});\r\n      if ( imageResponse.data != null ) {\r\n        pictures = imageResponse.data;\r\n      }\r\n      // 格式化商品详情数据，适配弹窗中表格的展示\r\n      this.formattedProductDetails = [\r\n        { label: '店铺名称', value: product.shop_name },\r\n        { label: '店铺描述', value: product.shop_description},\r\n        { label: '创建时间', value: product.created_time },\r\n        { label: '更新时间', value: product.updated_time },\r\n        { label: '店铺等级', value: product.level },\r\n        { label: '许可证', value: pictures },\r\n        { label: '特产地', value: product.location }\r\n      ];\r\n\r\n      // 打开弹窗\r\n      this.dialogInfoVisible = true;\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    async approveShop(shop) {\r\n      const proAddResponse = await axios.post('http://localhost:8081/shop/status',{id:shop.shop_id, status:\"closed\"});\r\n      if ( proAddResponse.status === 200) {\r\n        alert('已通过审核');\r\n        window.location.reload();\r\n      }\r\n    },\r\n    rejectShop(shop) {\r\n      this.currentShop = shop;\r\n      this.rejectDialogVisible = true;\r\n    },\r\n    async confirmReject() {\r\n      const proAddResponse = await axios.post('http://localhost:8081/shop/insertReason',{id:this.currentShop.shop_id, status:\"suspended\", reason:this.rejectReason});\r\n      if ( proAddResponse.status === 200) {\r\n        alert('已驳回申请');\r\n        window.location.reload();\r\n      }\r\n      this.rejectDialogVisible = false;\r\n    }\r\n  },\r\n  async created() {\r\n    const proAddResponse = await axios.post('http://localhost:8081/shop/',{});\r\n    if ( proAddResponse.data != null) {\r\n      this.shopList = proAddResponse.data.filter(product => product.status === 'waiting');\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.shop-audit {\r\n  .el-table {\r\n    margin-top: 20px;\r\n  }\r\n}\r\n</style> "],"mappings":";;AAuDA,OAAAA,KAAA;;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,uBAAA;MAAA;MACAC,iBAAA;MAAA;MACAC,QAAA;MACAC,mBAAA;MACAC,YAAA;MACAC,WAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,YAAAC,OAAA;MACA,IAAAC,QAAA;MACA;MACA,MAAAC,aAAA,SAAAb,KAAA,CAAAc,IAAA;QAAAC,EAAA,EAAAJ,OAAA,CAAAK;MAAA;MACA,IAAAH,aAAA,CAAAX,IAAA;QACAU,QAAA,GAAAC,aAAA,CAAAX,IAAA;MACA;MACA;MACA,KAAAC,uBAAA,IACA;QAAAc,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAQ;MAAA,GACA;QAAAF,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAS;MAAA,GACA;QAAAH,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAU;MAAA,GACA;QAAAJ,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAW;MAAA,GACA;QAAAL,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAY;MAAA,GACA;QAAAN,KAAA;QAAAC,KAAA,EAAAN;MAAA,GACA;QAAAK,KAAA;QAAAC,KAAA,EAAAP,OAAA,CAAAa;MAAA,EACA;;MAEA;MACA,KAAApB,iBAAA;IACA;IACA;IACA,MAAAqB,YAAAC,IAAA;MACA,MAAAC,cAAA,SAAA3B,KAAA,CAAAc,IAAA;QAAAC,EAAA,EAAAW,IAAA,CAAAE,OAAA;QAAAC,MAAA;MAAA;MACA,IAAAF,cAAA,CAAAE,MAAA;QACAC,KAAA;QACAC,MAAA,CAAAP,QAAA,CAAAQ,MAAA;MACA;IACA;IACAC,WAAAP,IAAA;MACA,KAAAlB,WAAA,GAAAkB,IAAA;MACA,KAAApB,mBAAA;IACA;IACA,MAAA4B,cAAA;MACA,MAAAP,cAAA,SAAA3B,KAAA,CAAAc,IAAA;QAAAC,EAAA,OAAAP,WAAA,CAAAoB,OAAA;QAAAC,MAAA;QAAAM,MAAA,OAAA5B;MAAA;MACA,IAAAoB,cAAA,CAAAE,MAAA;QACAC,KAAA;QACAC,MAAA,CAAAP,QAAA,CAAAQ,MAAA;MACA;MACA,KAAA1B,mBAAA;IACA;EACA;EACA,MAAA8B,QAAA;IACA,MAAAT,cAAA,SAAA3B,KAAA,CAAAc,IAAA;IACA,IAAAa,cAAA,CAAAzB,IAAA;MACA,KAAAG,QAAA,GAAAsB,cAAA,CAAAzB,IAAA,CAAAmC,MAAA,CAAA1B,OAAA,IAAAA,OAAA,CAAAkB,MAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}